var enemyClass,baseStores={player:{hp:50,dmg:1,goldInit:0,gear:{weapon:{level:1,upgradeCost:10,upgradeMod:2},armor:{level:1,upgradeCost:10,upgradeMod:3}}},enemy:{hp:3,dmg:1,goldDrop:30,eliteMod:4,bossMod:3},skills:{regen:{power:10,level:1,upgradeCost:1e3,powerIncrease:1,name:"Regen"},midas:{power:100,level:1,upgradeCost:1e3,powerIncrease:2,name:"Midas"},aura:{power:100,level:1,upgradeCost:1e3,powerIncrease:5,name:"Aura"}},world:{wave:{num:1,perWave:10,modifier:1.5},loop:{num:1,buffInit:{},buffStats:{goldPerMonster:1,dmgModifier:1,waveReduction:.5,dmgReduction:.5,costReduction:1}}}},statArchive={player:{totalDamage:0,totalGold:0,monstersKilled:0,highestLoop:1,timesClicked:1}},playerHPBar=document.getElementById("playerHPBar"),playerHPText=document.getElementById("playerCurrentHP"),playerMaxHPText=document.getElementById("playerMaxHP"),playerMessage=document.getElementById("playerMessage"),enemyHitBox=document.getElementById("enemyHitbox"),enemyHPBar=document.getElementById("enemyCurrentHP"),enemyHPText=document.getElementById("enemyHPText"),enemyMaxHPText=document.getElementById("enemyMaxHPText"),enemyGoldText=document.getElementById("enemyGold"),enemyDamageText=document.getElementById("enemyDamage"),enemyClassText=document.getElementById("enemyClass"),campfire_e=document.getElementById("campfire"),enemy_e=document.getElementById("enemy"),advanceBtn=document.getElementById("advance"),retreatBtn=document.getElementById("retreat"),nextBtn=document.getElementById("next"),counterDisplay=document.getElementById("enemyCounter"),waveCounterDisplay=document.getElementById("waveCounter"),goldDisplay=document.getElementById("goldDisplay"),weaponLvlEl=document.getElementById("weaponLvl"),weaponDMGEl=document.getElementById("weaponDMG"),weaponCostEl=document.getElementById("weaponCost"),armorLvlEl=document.getElementById("armorLvl"),armorHPEl=document.getElementById("armorHP"),armorCostEl=document.getElementById("armorCost"),weaponUpgrade=document.getElementById("weaponUpgrade"),armorUpgrade=document.getElementById("armorUpgrade"),player={...baseStores.player},enemyBase={...baseStores.enemy},party={...baseStores.party},world={...baseStores.world},skills={...baseStores.skills},isResting=!0,weapon=player.gear.weapon,armor=player.gear.armor,currentGold=player.goldInit,enemyMaxHP=enemyBase.hp,enemyCurrentHP=enemyBase.hp,enemyDMG=enemyBase.dmg,enemyGold=enemyBase.goldDrop,playerHP=player.hp,playerMaxHP=player.hp,waveNumber=world.wave.num,enemyCounter=1;function toggleResting(){for(var a,b=["campfire_e","enemy_e","retreatBtn","enemyHitBox"],c=0;c<b.length;c++)a=b[c],toggleShow(window[a]);isResting=!isResting}function healPlayer(){updatePlayerHealth(playerMaxHP)}function retreat(){enemyCounter=1,stopEnemyAttack(),toggleShow(advanceBtn),healPlayer(),toggleResting()}function advance(){toggleResting(),toggleShow(advanceBtn),spawnEnemy(),startEnemyAttack()}function restAtCampfire(){stopEnemyAttack(),healPlayer(),toggleShow(nextBtn),playerMessage.innerHTML="Wave Cleared.",toggleResting()}function nextWave(){updateWaveCounter(),enemyCounter=1,updateEnemyCounter(),playerMessage.innerHTML="",toggleShow(nextBtn),toggleResting(),spawnEnemy(),startEnemyAttack()}function toggleShow(a){a.classList.toggle("show")}function spawnEnemy(){setTimeout(function(){var a=eliteModifier(enemyBase);10===enemyCounter?(enemyCurrentHP=a.hp,enemyMaxHP=enemyCurrentHP,enemyGold=a.goldDrop,enemyDMG=a.dmg,enemyClass="Elite"):(enemyCurrentHP=enemyBase.hp,enemyMaxHP=enemyCurrentHP,enemyGold=enemyBase.goldDrop,enemyDMG=enemyBase.dmg,enemyClass="Minion"),updateEnemyStats(),updateEnemyHealth(enemyCurrentHP)},150)}var enemyAttackInterval=setInterval(enemyAttack,1e3),enemyAttack=function(){damagePlayer()};function startEnemyAttack(){enemyAttackInterval=setInterval(enemyAttack,2e3)}function stopEnemyAttack(){clearInterval(enemyAttackInterval)}function eliteModifier(a){var b=a.eliteMod;return{hp:a.hp*b,dmg:a.dmg*b,goldDrop:a.goldDrop*b}}function waveModifier(a){var b={...enemyBase,hp:Math.round(enemyBase.hp*a),dmg:Math.round(enemyBase.dmg*a),goldDrop:Math.round(enemyBase.goldDrop*a)};enemyBase=b}function addGold(a){currentGold+=a,updateGoldDisplay()}var upgradeGear=function(a,b){currentGold>=a.upgradeCost&&(currentGold-=a.upgradeCost,a.level++,a.upgradeCost*=a.upgradeMod,b()),upgradeDisplay()};function upgradeWeaponDMG(){upgradeGear(weapon,function(){player.dmg*=2})}function upgradeArmorHP(){var a=function(){playerMaxHP=Math.round(1.9*playerMaxHP),healPlayer()};upgradeGear(armor,a)}var upgradeDisplay=function(){updateGoldDisplay(),updateWeaponStats(),updateArmorStats()},buyRegenBtn=document.getElementById("buyRegenBtn"),buyMidasBtn=document.getElementById("buyMidasBtn"),buyAuraBtn=document.getElementById("buyAuraBtn"),upgradeRegenBtn=document.getElementById("upgradeRegenBtn"),upgradeMidasBtn=document.getElementById("upgradeMidasBtn"),upgradeAuraBtn=document.getElementById("upgradeAuraBtn"),regenCost=document.getElementById("regenCost"),midasCost=document.getElementById("midasCost"),auraCost=document.getElementById("auraCost"),regenBonus=document.getElementById("regenBonus"),midasBonus=document.getElementById("midasBonus"),auraBonus=document.getElementById("auraBonus"),regenUpgradeCost=document.getElementById("regenUpgradeCost"),midasUpgradeCost=document.getElementById("midasUpgradeCost"),auraUpgradeCost=document.getElementById("auraUpgradeCost"),regenText=document.getElementById("regen"),midasText=document.getElementById("midas"),auraText=document.getElementById("aura"),displaySkillEffect=function(){regenText.innerHTML=skills.regen.power,midasText.innerHTML=skills.midas.power,auraText.innerHTML=skills.aura.power},displaySkillCost=function(){regenCost.innerHTML=addSuffix(skills.regen.upgradeCost),midasCost.innerHTML=addSuffix(skills.midas.upgradeCost),auraCost.innerHTML=addSuffix(skills.aura.upgradeCost)};buyRegenBtn.onclick=function(){purchaseSkill(skills.regen)},buyMidasBtn.onclick=function(){purchaseSkill(skills.midas)},buyAuraBtn.onclick=function(){purchaseSkill(skills.aura)},displaySkillEffect(),displaySkillCost();var purchaseSkill=function(a){var b=a.upgradeCost;currentGold>=b&&(currentGold-=b,updateGoldDisplay(),activateSkill(a.name))},activateSkill=function(a){"Regen"===a?(castSpell("regen",regenEffect),toggleShow(buyRegenBtn),toggleShow(upgradeRegenBtn)):"Aura"===a?(castSpell("aura",auraEffect),toggleShow(buyAuraBtn),toggleShow(upgradeAuraBtn)):"Midas"===a?(castSpell("midas",midasEffect),toggleShow(buyMidasBtn),toggleShow(upgradeMidasBtn)):void 0},regenEffect=function(){!isResting&&playerHP<playerMaxHP&&updatePlayerHealth(playerHP+skills.regen.power)},auraEffect=function(){if(!isResting){var a=enemyCurrentHP-skills.aura.power;0>=a?(enemyCurrentHP=0,updateEnemyHealth(enemyCurrentHP),killEnemy()):updateEnemyHealth(a)}},midasEffect=function(){if(!isResting){var a=skills.midas.power;addGold(a)}},castSpell=function(a,b){clearInterval(a);var a=setInterval(b,1e3)};function addSuffix(a){var b=a;if(1e3<=a){for(var c=["","k","m","b","t","q","qn","sx","sp","o","n","d","ud","dd","td","qd","qnd","sxd","spd","od","nd","v","uv","dv","tv","qv","qnv","sxv","spv","ov","nv","tg"],d=Math.floor((""+a).length/3),e="",f=2;1<=f;f--){e=parseFloat((0==d?a:a/Math.pow(1e3,d)).toPrecision(f));var g=(e+"").replace(/[^a-zA-Z 0-9]+/g,"");if(2>=g.length)break}0!=e%1&&(e=e.toFixed(1)),b=e+c[d]}return b}function updateWeaponStats(){weaponLvlEl.innerHTML=weapon.level,weaponDMGEl.innerHTML=addSuffix(player.dmg),weaponCostEl.innerHTML=addSuffix(weapon.upgradeCost)}function updateArmorStats(){armorLvlEl.innerHTML=armor.level,armorCostEl.innerHTML=addSuffix(armor.upgradeCost)}function updateEnemyCounter(){counterDisplay.innerHTML=enemyCounter}function updateEnemyStats(){enemyDamageText.innerHTML=addSuffix(enemyDMG),enemyGoldText.innerHTML=addSuffix(enemyGold),enemyClassText.innerHTML=enemyClass}function updateWaveCounter(){waveNumber++,waveCounterDisplay.innerHTML=waveNumber,waveModifier(world.wave.modifier),enemyCounter=1,updateEnemyCounter()}function updateGoldDisplay(){goldDisplay.innerHTML=addSuffix(currentGold)}function damage(a,b,c,d){var e=a-b;0>=e?(e=0,d(e),c()):(a=e,d(a))}function damageEnemy(){damage(enemyCurrentHP,player.dmg,killEnemy,updateEnemyHealth)}var killEnemy=function(){var a=enemyBase.goldDrop,b=eliteModifier(enemyBase);10===enemyCounter?(a=b.goldDrop,addGold(a),restAtCampfire()):(enemyCounter++,addGold(a),updateEnemyCounter(),spawnEnemy())};function damagePlayer(){damage(playerHP,enemyDMG,killPlayer,updatePlayerHealth)}var killPlayer=function(){playerMessage.innerHTML="You died. Gold Lost: "+currentGold,currentGold=0,updateGoldDisplay(),retreat()};function updateHealth(a,b,c){"player"===c?playerHP=b:enemyCurrentHP=b;window[c+"HPBar"].style.width=100*(b/a)+"%",window[c+"HPText"].innerHTML=addSuffix(b),window[c+"MaxHPText"].innerHTML=addSuffix(a)}function updatePlayerHealth(a){updateHealth(playerMaxHP,a,"player")}function updateEnemyHealth(a){updateHealth(enemyMaxHP,a,"enemy")}updateEnemyCounter(),waveCounterDisplay.innerHTML=waveNumber,updateEnemyHealth(enemyBase.hp),updatePlayerHealth(playerHP),upgradeDisplay(),spawnEnemy(),updateEnemyStats(),enemyHitBox.onclick=function(){damageEnemy()},weaponUpgrade.onclick=function(){upgradeWeaponDMG()},armorUpgrade.onclick=function(){upgradeArmorHP()},advanceBtn.onclick=function(){advance()},nextBtn.onclick=function(){nextWave()},retreatBtn.onclick=function(){retreat()};